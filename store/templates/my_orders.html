{% extends "layout.html" %}
{% block body %}

        <script type="text/javascript">

            var count_tr=45;
            var tr = [];


            $(document).ready (function() {
            var page = 1;
            var table_grid = document.getElementById('grid');
            function createGrid(count)
                {
                    for (var i=1; i<=count;i++ )
                        {
                            tr[i] = document.createElement('TR');
                            table_grid.appendChild(tr[i]);
                            tr[i].id=i;
                            if (i % 2 == 0) tr[i].style.background = "#c0c0c0";
                            for (var j=0; j<=3; j++)
                                {
                                    tr[i].appendChild(document.createElement('TD'));
                                }
                        }
                    $( "tr:even" ).css( "background-color", "#c0c0c0" );
                }
            createGrid();

            function clearingTr(i)
                {
                    for (var j=0; j<=3; j++)
                        {
                            tr[i].cells[j].innerHTML='';
                        }
                }


            function clearingGrid()
                {
                    for (var n=1 ; n<=count_tr; n++)
                        {
                            clearingTr(n);
                        }
                }
            function deletingGrid()
                {
                    for (var n=table_grid.rows.length ; n>=2; n--)
                        {
                            table_grid.removeChild(table_grid.childNodes[n]);
                        }

                }


            function ajaxSuccess(json){
                deletingGrid()
                createGrid(json.orders.length)
                /*Create table */
                for (var order_k in json.orders)
                    {
                        k++;
                        tr[k].cells[0].innerHTML = json.orders[order_k].date;
                        tr[k].cells[1].innerHTML = json.orders[order_k].orderStatus;
                        tr[k].cells[2].innerHTML = "$ "+json.orders[order_k].amount;
                        tr[k].cells[3].innerHTML = "<img src='static/images/search.png' class='edit_img' alt=" + k + ">";
                        tr[k].cells[3].abbr=k;
                        tr[k].cells[3].onclick= function()
                            {
                                alert('Details')
                            }
                    }
                    k=0;
                    /*End creating table*/
            }

            var k=0;
            form_value = {id : $('#name_form').val(), name : $('#product_name').val()};
            json_value = JSON.stringify(form_value);


            $('#clr').click(deletingGrid);



            function gridPagination(){$.ajax({
                dataType: "json",
                url: '/api/orders/'+page,
                type: 'GET',
                contentType: "application/json",
                success: function(json)
                    {
                        ajaxSuccess(json);
                        records_amount=(json.records_amount);
                        records_per_page=(json.records_per_page);
                        pages_amount = Math.ceil(records_amount/records_per_page);
                        document.getElementById("page").innerHTML = page;
                        document.getElementById("pages_amount").innerHTML = pages_amount

                        if (page==1){
                            $('#prev').css({ "opacity":"0.4"});
                            $('#first').css({ "opacity":"0.4"});
                        } else {$('#prev').css({ "opacity": "1"});
                            $('#first').css({ "opacity": "1"});
                        }

                        if (page==pages_amount){
                            $('#next').css({ "opacity": "0.4"});
                            $('#last').css({ "opacity": "0.4"});
                        } else {$('#next').css({ "opacity": "1"});
                            $('#last').css({ "opacity": "1"});
                        }
                    }
                })
            }

            if (page==1){
                gridPagination();
            }

            $('#next').click(function(){
            if (page*records_per_page>=records_amount){page=page}
            else {page=page+1}
            gridPagination()
            });

            $('#prev').click(function(){
            page=page-1;
            if (page<=1){
            page=1;
            }
            gridPagination()
            });

            $('#first').click(function(){
            page=1;
            gridPagination()
            });

            $('#last').click(function(){
            page=pages_amount;
            gridPagination()
            });

            });
        </script>

        <div class="">

            <div style="margin-left:80%;">
            </div>
            <div id=" ">
                <table id='grid' class="grid">
                    <tr>
                        <th>
                            Date
                        </th>
                        <th>
                            Status
                        </th>
                        <th>
                            Amount
                        </th>
                        <th>
                            Details
                        </th>
                    </tr>
                </table>


            <div id="pagination" style="text-align: center">
                <input type="button" id="first" value="First">&nbsp
                <input type="button" id="prev" value="Prev">&nbsp

                <input type="button" id="next" value="Next">&nbsp
                <input type="button" id="last" value="Last">
                <div style="font-size:14px; color:#606860;">Page <span id="page"></span> of <span id="pages_amount"></span></div>
            </div>

            </div>

            </div>
        </div>
{% endblock body %}